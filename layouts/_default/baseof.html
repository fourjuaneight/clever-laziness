<!DOCTYPE HTML>
<html itemscope lang="{{ with .Site.LanguageCode }}{{ . }}{{ else }}en-US{{ end }}">
<head>
  {{ .Hugo.Generator }}
  <meta charset="utf-8" />
  <base href="{{ .Site.BaseURL }}">
  <title>{{ $url := replace .Permalink ( printf "%s" .Site.BaseURL) "" }}{{ if eq $url "/" }}{{ .Site.Title }}{{ else }}{{ if .Params.heading }}{{ .Params.heading }}{{ else }}{{ .Title }}{{ end }}{{ end }}</title>
  <meta name="author" content="{{ .Site.Author.name }}">
  <meta name="description" content="{{ .Site.Params.description }}">
  <meta name="keywords" content="{{ .Site.Params.keywords }}">
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,initial-scale=1.0,maximum-scale=5.0,viewport-fit=cover">
  <meta name="theme-color" content="#8F3A6D">
  
  <!-- RSS -->
  {{ $.Scratch.Set "bs" "" }}
  {{ if eq .Kind "taxonomy" }}
    {{ if eq .Section "genre" }}
      {{ $.Scratch.Set "bs" "bookshelf" }}
    {{ end }}
  {{ end }}
  <link
  href="{{ .Site.BaseURL }}{{ if or (eq .Section "bookshelf") (eq (.Scratch.Get "b") "bookshelf" ) }}bookshelf{{ else if eq .Section "microposts" }}microposts{{ else }}articles{{ end }}/feed.json"
  rel="alternate" type="application/json" title="{{ .Site.Title }}" />
  
  <!-- Open Graph -->
  {{ $avatar := resources.Get "icons/avatar.png" }}
  <link rel="canonical" href="{{ .Permalink }}">
  {{ template "_internal/twitter_cards.html" . }}
  <meta name="twitter:image" content="{{ $avatar.RelPermalink }}">
  {{ template "_internal/opengraph.html" . }}
  <meta property="og:image" content="{{ $avatar.RelPermalink }}">
  {{ template "_internal/schema.html" . }}

  <!-- Fonts -->  
  {{ $Rubik2 := resources.Get "fonts/Rubik.woff2" }}
  <link rel="preload" href={{ $Rubik2.Permalink }} as="font" type="font/woff2" crossorigin>
  {{ $Rubik := resources.Get "fonts/Rubik.woff" }}
  <link rel="preload" href={{ $Rubik.Permalink }} as="font" type="font/woff" crossorigin>
  {{ $Rubiki2 := resources.Get "fonts/Rubik-Italic.woff2" }}
  <link rel="preload" href={{ $Rubiki2.Permalink }} as="font" type="font/woff2" crossorigin>
  {{ $Rubiki := resources.Get "fonts/Rubik-Italic.woff" }}
  <link rel="preload" href={{ $Rubiki.Permalink }} as="font" type="font/woff" crossorigin>
  {{ $Rubikb2 := resources.Get "fonts/Rubik-Bold.woff2" }}
  <link rel="preload" href={{ $Rubikb2.Permalink }} as="font" type="font/woff2" crossorigin>
  {{ $Rubikb := resources.Get "fonts/Rubik-Bold.woff" }}
  <link rel="preload" href={{ $Rubikb.Permalink }} as="font" type="font/woff" crossorigin>
  
  {{ $Dys2 := resources.Get "fonts/OpenDyslexic.woff2" }}
  <link rel="preload" href={{ $Dys2.Permalink }} as="font" type="font/woff2" crossorigin>
  {{ $Dys := resources.Get "fonts/OpenDyslexic.woff" }}
  <link rel="preload" href={{ $Dys.Permalink }} as="font" type="font/woff" crossorigin>
  {{ $Dysb2 := resources.Get "fonts/OpenDyslexic-Bold.woff2" }}
  <link rel="preload" href={{ $Dysb2.Permalink }} as="font" type="font/woff2" crossorigin>
  {{ $Dysb := resources.Get "fonts/OpenDyslexic-Bold.woff" }}
  <link rel="preload" href={{ $Dysb.Permalink }} as="font" type="font/woff" crossorigin>

  {{ if .IsPage }}
    {{ $Plex2 := resources.Get "fonts/PlexMono.woff2" }}
    <link rel="preload" href={{ $Plex2.Permalink }} as="font" type="font/woff2" crossorigin>
    {{ $Plex := resources.Get "fonts/PlexMono.woff" }}
    <link rel="preload" href={{ $Plex.Permalink }} as="font" type="font/woff" crossorigin>
    {{ $Plexi2 := resources.Get "fonts/PlexMono-Italic.woff2" }}
    <link rel="preload" href={{ $Plexi2.Permalink }} as="font" type="font/woff2" crossorigin>
    {{ $Plexi := resources.Get "fonts/PlexMono-Italic.woff" }}
    <link rel="preload" href={{ $Plexi.Permalink }} as="font" type="font/woff" crossorigin>
  {{ end }}
  
  <!-- Critical -->
  {{ partial "critical.html" . }}

  <!-- Stylesheets -->
  {{ if .IsPage }}
    {{ $single := resources.Get "css/single.scss" | toCSS | postCSS | minify }}
    <link rel="stylesheet" href="{{ $single.Permalink }}" media="screen">
  {{ else }}
    {{ $main := resources.Get "css/main.scss" | toCSS | postCSS | minify }}
    <link rel="stylesheet" href="{{ $main.Permalink }}" media="screen">
  {{ end }}

  <!-- Linting -->
  <!-- {{ $linting := resources.Get "css/linting.scss" | toCSS | postCSS | minify }}
  <link rel="stylesheet" href="{{ $linting.Permalink }}" media="screen"> -->
  
  <!-- Manifest -->
  {{ $manifest := resources.Get "manifest.json" }}
  <link rel="manifest" href="{{ $manifest.RelPermalink }}">

  <!-- Favicon -->
  {{ $favicon := resources.Get "icons/favicon.png" }}
  <link rel="shortcut icon" href="{{ $favicon.RelPermalink }}" i>

  <!-- Webclip and Apple Touch Icon -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="{{ .Site.Title }}">
  {{ $ati152 := resources.Get "icons/apple-touch-icon-152x152.png" }}
  <link rel="apple-touch-icon" sizes="152x152" href="{{ $ati152.RelPermalink }}">
  {{ $ati167 := resources.Get "icons/apple-touch-icon-167x167.png" }}
  <link rel="apple-touch-icon" sizes="167x167" href="{{ $ati167.RelPermalink }}">
  {{ $ati180 := resources.Get "icons/apple-touch-icon-180x180.png" }}
  <link rel="apple-touch-icon" sizes="180x180" href="{{ $ati180.RelPermalink }}">
  {{ $spt := resources.Get "icons/safari-pinned-tab.svg" | minify }}
  <link rel="mask-icon" color="#BB3117" href="{{ $spt.RelPermalink }}">

  <!-- Icons -->
  {{ $i128 := resources.Get "icons/icon-128x128.png" }}
  <link rel="icon" sizes="128x128" href="{{ $i128.RelPermalink }}">
  {{ $i192 := resources.Get "icons/icon-192x192.png" }}
  <link rel="icon" sizes="192x192" href="{{ $i192.RelPermalink }}">
  {{ $i512 := resources.Get "icons/icon-512x512.png" }}
  <link rel="icon" sizes="512x512" href="{{ $i512.RelPermalink }}">

  <!-- Keybase Proof -->
  {{ $keybase := resources.Get "keybase.txt" }}
  <link href="{{ $keybase.RelPermalink }}">
</head>
<body id="rubik" class="light" data-type="{{ .Kind }}">
  {{ partial "header.html" . }}

  <!-- Main content -->
  {{ block "main" . }}
  {{ end }}

  {{ partial "footer.html" . }}

  <!-- Stuff -->
  <section class="stuff">
    <p class="small">Guess what happens when you go smaller?</p>
    <p class="smaller">Nothing.</p>
  </section>

  {{ partial "ui-options.html" . }}

  {{ block "lazy" . }}
  {{ end }}

  <!-- SW -->
  {{ $sw := resources.Get "sw.js" | minify }}
  <script>
    if (navigator.serviceWorker) {
      navigator.serviceWorker.register("{{ $sw.RelPermalink }}", { scope: "/" });
      navigator.serviceWorker.ready.then(registration => {
        console.log(`                                  ....
                                .'' .'''
.                             .'   :
\\                          .:    :
 \\                        _:    :       ..----.._
  \\                    .:::.....:::.. .'         ''.
   \\   -----------   .'  #-. .-######'     #        '.
    \\ | SW Ready! |    '.##'/ ' ################       :
     \\ -----------      #####################         :
      \\               ..##.-.#### .''''###'.._        :
       \\             :--:########:            '.    .' :
        \\..__...--.. :--:#######.'   '.         '.     :
        :     :  : : '':'-:'':'::        .         '.  .'
        '---'''..: :    ':    '..'''.      '.        :'
           \\  :: : :     '      ''''''.     '.      .:
            \\ ::  : :     '            '.      '      :
             \\::   : :           ....' ..:       '     '.
              \\::  : :    .....####\\ .~~.:.             :
               \\':.:.:.:'#########.===. ~ |.'-.   . '''.. :
                \\    .'  ########## \ \ _.' '. '-.       '''.
                :\\  :     ########   \ \      '.  '-.        :
               :  \\'    '   #### :    \ \      :.    '-.      :
              :  .'\\   :'  :     :     \ \       :      '-.    :
             : .'  .\\  '  :      :     :\ \       :        '.   :
             ::   :  \\'  :.      :     : \ \      :          '. :
             ::. :    \\  : :      :    ;  \ \     :           '.:
              : ':    '\\ :  :     :     :  \:\     :        ..'
                 :    ' \\ :        :     ;  \|      :   .'''
                 '.   '  \\:                         :.''
                  .:..... \\:       :            ..''
                 '._____|'.\\......'''''''.:..'''
                            \\`);
      });
      window.addEventListener("load", () => {
        if (navigator.serviceWorker.controller) {
          navigator.serviceWorker.controller.postMessage({ command: "trimCaches" });
        }
      });
    }
  </script>

  <!-- UI Switcher -->
  {{ $ui := resources.Get "js/ui.js" | minify }}
  <script src="{{ $ui.Permalink }}"></script>
  
  <!-- Scripts -->
  {{ if or (.IsPage) (eq .Kind "section") }}
  {{ $barefoot := resources.Get "js/barefoot.js" }}
  {{ $copy := resources.Get "js/copy.js" }}
  {{ $filterSort := resources.Get "js/filter-sort.js" }}
  {{ $scripts := slice $barefoot $copy $filterSort | resources.Concat "js/scripts.js" | minify }}
  <script src="{{ $scripts.Permalink }}"></script>
  {{ end }}
  
  <!-- Barefoot -->
  {{ if .IsPage }}
  <script>
    lf = new BareFoot();
    lf.init();
  </script>
  {{ end }}
  <!-- a11y -->
  <!-- {{ $tota11y := resources.Get "js/tota11y.js" | minify }}
  <script src="{{ $tota11y.Permalink }}"></script> -->
</body>
</html>